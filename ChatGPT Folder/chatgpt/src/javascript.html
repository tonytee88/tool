<script>

window.addEventListener('load', function() {
  console.log('Page is loaded');
});

var optionsCount = 1;
const optionsTotal = 3;
const designOptions = 3; // Number of design options

var globalApiResponse = {
  "hero banner title": {
    "option1": "Ride in style with our Bike Flash Sale!",
    "option2": "Unbeatable deals on bikes this week only!",
    "option3": "Get ready to bike your heart out with our Flash Sale!"
  },
  "hero banner text": {
    "option1": "Don't miss out on the bike sale event of the year!",
    "option2": "Get your hands on the finest bikes at the most amazing prices!",
    "option3": "Upgrade your ride at our epic Flash Sale! Hurry, limited time only!"
  },
  "hero banner cta": {
    "option1": "Don't miss out on the bike sale event of the year!",
    "option2": "Get your hands on the finest bikes at the most amazing prices!",
    "option3": "Upgrade your ride at our epic Flash Sale! Hurry, limited time only!"
  }

};

var heroBannerTitle;
var heroBannerText;
var heroBannerCTA;
var designTips;

const qaButtonClick = document.getElementById("qaButton");

qaButtonClick.addEventListener("click", function() {

  var topContainer = document.getElementById("topContainer");
  topContainer.setAttribute("gpt-request-status", "generate-design-tips");

  heroBannerTitle = globalApiResponse["hero banner title"]["option" + optionsCount];
  heroBannerSubtitle = globalApiResponse["hero banner text"]["option" + optionsCount];
  heroBannerCTA = globalApiResponse["hero banner cta"]["option" + optionsCount];

  var tableContainer = document.getElementById("tableContainer");
    tableContainer.innerHTML = "";

    // Generate a new table with 4 rows
    for (var i = 1; i <= designOptions; i++) {
    // Create a new table for each design option
    var newTable = document.createElement("table");
    newTable.id = 'designTable' + i;

    // Create the first row with two divs
    var row1 = document.createElement("tr");

    var cell1 = document.createElement("td");
    var div1 = document.createElement("div");
    div1.textContent = "Option " + i;
    // Apply CSS styles to div1

    var cell2 = document.createElement("td");
    var div2 = document.createElement("div");

    // Create a button element
    var deleteButton = document.createElement("button");
    deleteButton.id = 'deleteDesignIdea' + i;
    deleteButton.innerHTML = "&#128465"; // Unicode character for trash can
    deleteButton.style.fontSize = "12px"; // Set the font size to make the button small

    // Apply CSS styles to the button
    //deleteButton.style.boxShadow = "0 0 5px rgba(0, 0, 0, 0.3)";
    deleteButton.style.transition = "box-shadow 0.3s ease-in-out";

    // Add event listeners for hover and click animations
    deleteButton.addEventListener("mouseover", function() {
      this.style.boxShadow = "0 0 10px rgba(0, 0, 0, 0.5)";
    });

    deleteButton.addEventListener("mouseout", function() {
      this.style.boxShadow = "0 0 5px rgba(0, 0, 0, 0.3)";
    });

    deleteButton.addEventListener("click", createDeleteTableHandler(i)); // Call a separate function to handle the deletion

    // Append the button to the second div
    div2.appendChild(deleteButton);

    cell1.appendChild(div1);
    cell2.appendChild(div2);
    row1.appendChild(cell1);
    row1.appendChild(cell2);

    newTable.appendChild(row1);
    // Create the second row with the response from the API call
    var row2 = document.createElement("tr");
    var cell3 = document.createElement("td");
    cell3.colSpan = 2;
    cell3.id = "cell3_option" + i;
    cell3.className = "cell3_option";
    //var response = getGPTDesignResponse(lang, heroBannerTitle, heroBannerText, heroBannerCTA, subject, info);
    //cell3.textContent = "Response: " + JSON.stringify(response.result);
    
    row2.appendChild(cell3);
    newTable.appendChild(row2);

    // Append the new table to the table container
    var tableContainer = document.getElementById("tableContainer");
    tableContainer.appendChild(newTable);
  }

    var addButton = document.createElement("button");
    addButton.id = "addDesignTips";
    addButton.className = "option-button";
    addButton.textContent = "Add Design Tip";

    tableContainer.appendChild(addButton);


    // Find the textarea with class "large-input"
    var textarea = document.querySelector(".large-input");
    textarea.value = "Focus on the sale"; // Change the text

    //Scroll back to the top for best UX
    document.documentElement.scrollTop = 0; // For modern browsers
    document.body.scrollTop = 0; // For older browsers

    // Add an animation to the textarea
    textarea.classList.add("textarea-animation");
    setTimeout(function() {
      textarea.classList.remove("textarea-animation");
    }, 1000);

    const handleAddDesignTipsButtonClick = document.getElementById("addDesignTips");

    handleAddDesignTipsButtonClick.addEventListener("click", function() {
    var designTips = document.getElementsByClassName("cell3_option");
    var designTipsText = [];

    for (var i = 0; i < designTips.length; i++) {
      var designTip = designTips[i];
      var textContent = designTip.textContent.trim(); // Trim the text content
      designTipsText.push(textContent);
    }

    console.log(designTipsText);
    google.script.run.addDesignTips(designTipsText);
  });


});

function loadTags() {
  google.script.run.withSuccessHandler(processTags).getTags();
}

function processTags(tags) {
  var topContainer = document.getElementById("topContainer");
  topContainer.setAttribute("gpt-request-status", "generate-copy");

  var tagList = document.getElementById('tagList');
  tagList.innerHTML = ''; // Clear existing content

  // Create the tag list table
  var table = document.createElement('table');
  table.id = 'mainTable';

  // Iterate over each tag and create table rows
  tags.forEach(function (tag) {
    // Create unique IDs for buttons and tagsWithDelimitersCell
    var buttonId = 'button_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');
    var tagsWithDelimitersCellId = 'tagsCell_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');
    
    // Create the first row
    var firstRow = document.createElement('tr');

    // Create the cells for the first row
    var emptyCell = document.createElement('td');
    var tagsWithoutDelimitersCell = document.createElement('td');
    tagsWithoutDelimitersCell.textContent = tag.replace('{', '').replace('}', '');
    tagsWithoutDelimitersCell.className = 'title-content-cell';
  
    // Append the cells to the first row
    firstRow.appendChild(emptyCell);
    firstRow.appendChild(tagsWithoutDelimitersCell);

    // Create the second row
    var secondRow = document.createElement('tr');

    // Create the cells for the second row
    var buttonCell = document.createElement('td');
    var tagsWithDelimitersCell = document.createElement('td');
    tagsWithDelimitersCell.textContent = tag;
    tagsWithDelimitersCell.className = 'text-content-cell ';
    tagsWithDelimitersCell.id = tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');

    // Set the initial data-option attribute
    tagsWithDelimitersCell.setAttribute('data-option', '1');
    // Create button container
    var buttonContainer = document.createElement('div');
    buttonContainer.className = 'button-container';
    buttonCell.appendChild(buttonContainer);

    // Create the options hover-over element
    var optionsHover = document.createElement('div');
    optionsHover.className = 'options-hover';
    optionsHover.id = 'optionsHover_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');
    optionsHover.textContent = "Options: "

    // Attach the hover-over element to the optionsHoverBottom element
    var optionsHoverBottom = document.getElementById('optionsHoverBottom');
    optionsHoverBottom.appendChild(optionsHover);

    // Add event listeners for hover events
    buttonCell.addEventListener('mouseenter', function () {
    var optionsHoverId = 'optionsHover_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');
    var optionsHover = document.getElementById(optionsHoverId);
    optionsHover.style.display = 'block';
    bottomContainer.style.display = 'block';
    });

    buttonCell.addEventListener('mouseleave', function () {
    var optionsHoverId = 'optionsHover_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', '');
    var optionsHover = document.getElementById(optionsHoverId);
    optionsHover.style.display = 'none';
    bottomContainer.style.display = 'none';
    });

    // Create the button elements with unique IDs
    var backButton = document.createElement('button');
    backButton.textContent = '◄';
    backButton.className = 'back-button';
    backButton.style.border = 'none';
    backButton.id = buttonId; // Set the unique ID

    var nextButton = document.createElement('button');
    nextButton.textContent = '►';
    nextButton.className = 'next-button';
    nextButton.style.border = 'none';
    nextButton.id = buttonId + '_next'; // Set the unique ID

    // Append the button to the button cell
    buttonContainer.appendChild(backButton);
    buttonContainer.appendChild(nextButton);

    // Append the rows to the table
    table.appendChild(firstRow);
    table.appendChild(secondRow);

    // Append the cells to the second row
    secondRow.appendChild(buttonCell);
    secondRow.appendChild(tagsWithDelimitersCell);
  

    // Apply border styles to cells
    emptyCell.style.border = 'none'; // No border for the empty cell
    tagsWithoutDelimitersCell.style.border = 'none'; // No border for the cell spanning both columns
    buttonCell.style.border = 'none'; // No border for the button cell
    tagsWithDelimitersCell.style.border = '2px solid #000'; // Thick border for the second cell of the second row
    
    // Add the click event listener to the "Back" button
    backButton.addEventListener('click', function() {
      var buttonId = this.id;
      var tagsWithDelimitersCellId = buttonId.replace('button_', ''); // Remove the 'button_' prefix
      var tagsWithDelimitersCell = document.getElementById(tagsWithDelimitersCellId);
      var test183 = parseInt(tagsWithDelimitersCell.getAttribute('data-option'));
      
      showPreviousOption(tagsWithDelimitersCell, tagsWithDelimitersCellId);
    });

    // Add the click event listener to the "Next" button
    nextButton.addEventListener('click', function() {
      var buttonId = this.id;
      var tagsWithDelimitersCellId = buttonId.replace('button_', ''); // Remove the 'button_' prefix
      tagsWithDelimitersCellId = tagsWithDelimitersCellId.replace('_next', ''); // Remove the '_next' suffix
      var tagsWithDelimitersCell = document.getElementById(tagsWithDelimitersCellId);
      showNextOption(tagsWithDelimitersCell, tagsWithDelimitersCellId);
    });
    backButton.addEventListener('click', function() {
    backButton.classList.add('clicked');
    setTimeout(function() {
      backButton.classList.remove('clicked');
    }, 500);
    // Rest of your code...
  });

  nextButton.addEventListener('click', function() {
    nextButton.classList.add('clicked');
    setTimeout(function() {
      nextButton.classList.remove('clicked');
    }, 500);
    // Rest of your code...
  });


  });

  // Append the table to the tag list element
  tagList.appendChild(table);

  //end of table generating code
   
  const handleUpdateButtonClick = document.getElementById("update");

  handleUpdateButtonClick.addEventListener("click", function() {
    var cells = document.getElementsByClassName("title-content-cell");
    var finalObjectResult = {};

    for (var i = 0; i < cells.length; i++) {
      var cell = cells[i];
      var cellText = cell.innerText.trim();
      var nextRow = cell.parentNode.nextElementSibling;
      var nextCell = nextRow ? nextRow.children[cell.cellIndex] : null;

      if (nextCell !== null && nextCell.classList.contains("text-content-cell")) {
        var key = "{" + cellText + "}";
        var value = nextCell.innerText.trim();
        finalObjectResult[key] = value;
      }
    }
    // Call a function in your Code.gs file to update the document with finalObjectResult
    google.script.run.updateDocument(finalObjectResult);


    //end of updatedocument
    //create elements for design phase
    
        //Change gpt-request-status
    var topContainer = document.getElementById("topContainer");
    topContainer.setAttribute("gpt-request-status", "generate-design-tips");

    // Get the text content of the required divs
    try {
      heroBannerTitle = document.getElementById("hero-banner-title").textContent.trim();
      heroBannerSubtitle = document.getElementById("hero-banner-text").textContent.trim();
      heroBannerCTA = document.getElementById("hero-banner-cta").textContent.trim();

      // If an error occurs within the try block, the catch block will handle it
    } catch (error) {
      // Code to handle the error
      console.error('An error occurred:', error.message);
      var statusMessage = document.getElementById("statusMessage");
      // Set the message to indicate the running state
      statusMessage.textContent = "Make sure your tags include : 'hero banner title', 'hero banner text' and 'hero banner cta'";
    }

    // Clear the content of div with id="tableContainer"
    var tableContainer = document.getElementById("tableContainer");
    tableContainer.innerHTML = "";

    // Generate a new table with 4 rows
    for (var i = 1; i <= designOptions; i++) {
    // Create a new table for each design option
    var newTable = document.createElement("table");
    newTable.id = 'designTable' + i;

    // Create the first row with two divs
    var row1 = document.createElement("tr");

    var cell1 = document.createElement("td");
    var div1 = document.createElement("div");
    div1.textContent = "Option " + i;
    // Apply CSS styles to div1

    var cell2 = document.createElement("td");
    var div2 = document.createElement("div");

    // Create a button element
    var deleteButton = document.createElement("button");
    deleteButton.id = 'deleteDesignIdea' + i;
    deleteButton.innerHTML = "&#128465"; // Unicode character for trash can
    deleteButton.style.fontSize = "12px"; // Set the font size to make the button small

    // Apply CSS styles to the button
    //deleteButton.style.boxShadow = "0 0 5px rgba(0, 0, 0, 0.3)";
    deleteButton.style.transition = "box-shadow 0.3s ease-in-out";

    // Add event listeners for hover and click animations
    deleteButton.addEventListener("mouseover", function() {
      this.style.boxShadow = "0 0 10px rgba(0, 0, 0, 0.5)";
    });

    deleteButton.addEventListener("mouseout", function() {
      this.style.boxShadow = "0 0 5px rgba(0, 0, 0, 0.3)";
    });

    deleteButton.addEventListener("click", createDeleteTableHandler(i)); // Call a separate function to handle the deletion

    // Append the button to the second div
    div2.appendChild(deleteButton);

    cell1.appendChild(div1);
    cell2.appendChild(div2);
    row1.appendChild(cell1);
    row1.appendChild(cell2);

    newTable.appendChild(row1);
    // Create the second row with the response from the API call
    var row2 = document.createElement("tr");
    var cell3 = document.createElement("td");
    cell3.colSpan = 2;
    cell3.id = "cell3_option" + i;
    cell3.className = "cell3_option";
    //var response = getGPTDesignResponse(lang, heroBannerTitle, heroBannerText, heroBannerCTA, subject, info);
    //cell3.textContent = "Response: " + JSON.stringify(response.result);
    
    row2.appendChild(cell3);
    newTable.appendChild(row2);

    // Append the new table to the table container
    var tableContainer = document.getElementById("tableContainer");
    tableContainer.appendChild(newTable);

  }
    var addButton = document.createElement("button");
    addButton.id = "addDesignTips";
    addButton.className = "option-button";
    addButton.textContent = "Add Design Tip";

    tableContainer.appendChild(addButton);
 










    // Find the textarea with class "large-input"
    var textarea = document.querySelector(".large-input");
    textarea.value = "Focus on the sale"; // Change the text

    //Scroll back to the top for best UX
    document.documentElement.scrollTop = 0; // For modern browsers
    document.body.scrollTop = 0; // For older browsers

    // Add an animation to the textarea
    textarea.classList.add("textarea-animation");
    setTimeout(function() {
      textarea.classList.remove("textarea-animation");
    }, 1000);

    const handleAddDesignTipsButtonClick = document.getElementById("addDesignTips");

    handleAddDesignTipsButtonClick.addEventListener("click", function() {
    var designTips = document.getElementsByClassName("cell3_option");
    var designTipsText = [];

    for (var i = 0; i < designTips.length; i++) {
      var designTip = designTips[i];
      var textContent = designTip.textContent.trim(); // Trim the text content
      designTipsText.push(textContent);
    }

    console.log(designTipsText);
    google.script.run.addDesignTips(designTipsText);
  });
  
});
}

//END OF PROCESS TAG FUNCTION
//----------------------------------------------------------------------------------------------------------------

function showOptionsOnHover(tag, optionsCount) {
  var responseForOptionsHover = globalApiResponse;

  // Check if the response is available
  if (responseForOptionsHover && responseForOptionsHover.hasOwnProperty(tag)) {

    var optionsHoverBottom = document.getElementById('optionsHoverBottom');
    var optionElementGeneratedContainer = document.getElementById('optionsHover_' + tag.replace(/\s+/g, '-').replace('{', '').replace('}', ''));
    optionsHoverBottom.appendChild(optionElementGeneratedContainer);

    //optionsHoverBottom.style.display = 'none'; // Hide the options initially
    // Loop through the options and add them to the optionsHoverBottom element
    for (var optionCount = 1; optionCount <= optionsTotal; optionCount++) {

      var optionText = optionCount + " - " + responseForOptionsHover[tag]["option" + optionCount];
      var optionElement = document.createElement('div');
      optionElement.textContent = optionText;
          optionElementGeneratedContainer.appendChild(optionElement);
    }

  }
}

function showPreviousOption(tagsWithDelimitersCell,tagsWithDelimitersCellId) {
  var optionsCount = parseInt(tagsWithDelimitersCell.getAttribute('data-option'));
  var previousOptionIndex = optionsCount === 1 ? optionsTotal : optionsCount - 1;
  var tag = tagsWithDelimitersCellId.replace(/-/g, ' ');
  var generatedCopyPrevious = globalApiResponse[tag]["option" + previousOptionIndex];
  tagsWithDelimitersCell.textContent = generatedCopyPrevious;
  tagsWithDelimitersCell.setAttribute('data-option', previousOptionIndex.toString());
}

function showNextOption(tagsWithDelimitersCell,tagsWithDelimitersCellId) {
  var optionsCount = parseInt(tagsWithDelimitersCell.getAttribute('data-option'));
  var nextOptionIndex = optionsCount === optionsTotal ? 1 : optionsCount + 1;
  var tag = tagsWithDelimitersCellId.replace(/-/g, ' ');
  var generatedCopyNext = globalApiResponse[tag]["option" + nextOptionIndex];
  tagsWithDelimitersCell.textContent = generatedCopyNext;
  tagsWithDelimitersCell.setAttribute('data-option', nextOptionIndex.toString());
}


var exampleObj = {
    "element1": {
      "option1": "generated copy1",
      "option2": "generated copy2",
      "option3": "generated copy3",
      "option4": "generated copy4",
      "option5": "generated copy5"
    }
  };

function updateTextContentCells(response, optionsCount) {

  var topContainer = document.getElementById("topContainer");
  var gptRequestStatus = topContainer.getAttribute("gpt-request-status");

  if (gptRequestStatus === "generate-copy") {

  var titleContentCells = document.getElementsByClassName("title-content-cell");
  var textContentCells = document.getElementsByClassName("text-content-cell");
  
  for (var i = 0; i < titleContentCells.length; i++) {
    var tag = titleContentCells[i].textContent;
    if (response.hasOwnProperty(tag)) {
      var generatedCopy = response[tag]["option" + optionsCount];
      textContentCells[i].textContent = generatedCopy;
    } else {
      console.log("Tag not found in response:", tag);
    }
  }

  return response;
} else {
  // var cell3_option = document.getElementsByClassName("cell3_option");

  // for (var i = 1; i <= designOptions; i++) {
  // var generatedDesignOption = response["Option" + i];
  // var generatedDesignOption1 = response["Option" + i]["Description"];
  // console.log(generatedDesignOption);
  // cell3_option[i - 1].textContent = generatedDesignOption;
  for (var i = 1; i <= designOptions; i++) {
  var optionKey = "Option" + i;
  if (response.hasOwnProperty(optionKey)) {
    var backgroundText = response[optionKey]["Background"];
    var descriptionText = response[optionKey]["Description"];
    var designElementText = response[optionKey]["DesignElement"];
    
    // Get the div element with the corresponding unique id
    var divId = "cell3_option" + i;
    var divElement = document.getElementById(divId);
    
    // Check if the div element exists
    if (divElement) {
      // Update the inner HTML of the div with the text content
      divElement.innerHTML = `
        <p>Background: ${backgroundText}</p>
        <p>Description: ${descriptionText}</p>
        <p>Design Element: ${designElementText}</p>
      `;
    }
  }
  }  
  }
};



const gptRequest = document.getElementById("gptRequest");

gptRequest.addEventListener("submit", (e) => {
  e.preventDefault();

  // Get the subject in form
  function getSubject() {
    var subjectInput = document.getElementById("subject");
    var prompt = subjectInput.value;
    return prompt;
  }

  function getLang() {
    var langInput = document.getElementById("lang");
    var lang = langInput.value;
    return lang;
  }

  function getInfo() {
    var infoInput = document.getElementById("info");
    var info = infoInput.value;
    return info;
  }

  // Grab the prompt elements
  function getPromptElements() {
    var promptElements = [];
    var searchPattern = /\{([^}]+)\}/g;
    var inputs = document.querySelectorAll("#mainTable td.text-content-cell");

       inputs.forEach(function (input) {
      var tagText = input.textContent;
      //console.log("Tag Text:", tagText); // Log the tag text for debugging

      var matches = tagText.match(searchPattern);
      //console.log("Matches:", matches); // Log the matches for debugging

      if (matches) {
        for (var i = 0; i < matches.length; i++) {
          var tag = matches[i].replace('{', '').replace('}', '');
          promptElements.push(tag);
        }
      }
    });
    return promptElements;
  }

  var prompt = getSubject();
  var lang = getLang();
  var info = getInfo();
  var promptElements = getPromptElements();
  var subject = getSubject();

  // Make the API call
  var statusMessage = document.getElementById("statusMessage");
  // Set the message to indicate the running state
  statusMessage.textContent = "Talking to ChatGPT...";

  console.log("ok prompt: " + prompt + " and ok prompt elements: " + promptElements) + "and ok lang: " + lang;

  new Promise((resolve, reject) => {
  // Add your condition based on gpt-request-status here
  var topContainer = document.getElementById("topContainer");
  var gptRequestStatus = topContainer.getAttribute("gpt-request-status");
  console.log("subject: ", subject, "herobannertitle: ", heroBannerTitle, "info: ", info);

  if (gptRequestStatus === "generate-copy") {
    // Run getGPTResponse
    google.script.run
      .withSuccessHandler((result) => {
        console.log("Success:", result);
        globalApiResponse = result;
        resolve(result);
      })
      .withFailureHandler((error) => {
        console.log("Error:", error);
        reject(error);
      })
      .getGPTResponse(prompt, promptElements, optionsTotal, lang, info);

  } else {
    // Run getGPTDesignResponse
    google.script.run
      .withSuccessHandler((result) => {
        console.log("Success:", result);
        globalApiResponse = result;
        resolve(result);
      })
      .withFailureHandler((error) => {
        console.log("Error:", error);
        reject(error);
      })
      .getGPTDesignResponse(lang, heroBannerTitle, heroBannerText, heroBannerCTA, subject, info);
  }
})
  .then((result) => {
    statusMessage.textContent = "Translating with ChatGPT...";
    if (lang === "English") {
      // Skip requestTranslation and continue to the next step
      return Promise.resolve(result);
    } else {
      // Proceed with requestTranslation
      return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => {
            console.log("Success:", result);
            globalApiResponse = result;
            resolve(result);
          })
          .withFailureHandler((error) => {
            console.log("Error:", error);
            reject(error);
          })
          .requestTranslation(result, lang);
      });
    }
  })
  .then((result) => {
    statusMessage.textContent = "Negociation with Open AI servers...";
    // Handle the API response
    return new Promise((resolve, reject) => {
      updateTextContentCells(result, optionsCount);
      resolve(result);
    });
  })
  .then((result) => {
    statusMessage.textContent = "Script completed.";
    // Process each tag and call showOptionsOnHover
    promptElements.forEach((tag) => {
      showOptionsOnHover(tag, optionsCount);
    });
  })
  .catch((error) => {
    console.error("Error:", error);
    statusMessage.textContent = "Script encountered an error.";
  });

});

function getTopContainerStatus() {
  var topContainerStatus = ""; // Initialize the status
  
  // Use HtmlService to access the HTML content
  var html = HtmlService.createHtmlOutputFromFile('index').getContent();
  
  // Use DOM methods to parse and manipulate the HTML content
  var document = XmlService.parse(html);
  var root = document.getRootElement();
  var topContainerElement = root.getChild('div', { 'id': 'topContainer' });
  
  if (topContainerElement) {
    var statusAttribute = topContainerElement.getAttribute('gpt-request-status');
    if (statusAttribute) {
      topContainerStatus = statusAttribute.getValue();
    }
  }
  
  return topContainerStatus;
}
function createDeleteTableHandler(index) {
  return function() {
    var designTableId = 'designTable' + index; // Get the corresponding table id to be deleted
    var designTable = document.getElementById(designTableId);
    if (designTable) {
      designTable.remove(); // Delete the table
    }
  };
}


</script>

